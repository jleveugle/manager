<div class="telecom-pack-domain-activation">

    <header>
        <tuc-section-back-link data-tuc-section-back-link-to-state="pack"></tuc-section-back-link>
        <h1 data-translate="domain_activation_widget_title"></h1>
    </header>

    <div class="telecom-section-content">

        <tuc-toast-message></tuc-toast-message>

        <div class="text-center" data-ng-if="$ctrl.isLoading">
            <oui-spinner></oui-spinner>
        </div>

        <div class="row" data-ng-if="!$ctrl.isLoading && $ctrl.locker.activatedDomains.length !== 0">
            <section class="widget-presentation col-xs-12 col-md-6">
                <h2 class="widget-presentation-title"
                    data-translate="domain_activation_activated_domains_reminder">
                </h2>
                <ul>
                    <li data-ng-repeat="domain in $ctrl.locker.activatedDomains" data-ng-bind="domain">??</li>
                </ul>
            </section>
        </div>

        <div class="row" data-ng-if="!$ctrl.isLoading">
            <section class="widget-presentation col-xs-12 col-md-6">
                <h2 class="widget-presentation-title"
                    data-translate="domain_activation_widget_intro1">
                </h2>

                <form data-ng-if="$ctrl.locker.tldList.length !== 0"
                      name="domainActivation">

                    <!--select domain-->
                    <div class="input-select">
                        <label for="inputDomain"
                               class="control-label"
                               data-ng-bind=":: 'domain_activation_form_domain_label' | translate | tucCapitalize">
                        </label>
                          <!-- For regex below
                          \x22 is " (double quote)
                          \x27 is ' (single quote)
                          \xa0 is   (unbreakable space)
                          \x20 is   (space)

                          Waiting for the api to check the validity of a domain,
                          we have to be relatively "permissive". We won't refuse a
                          valid domain. But we can accept a domain who will be
                          rejected later by the api. For now I have no better way.
                          -->
                        <div class="form-inline form-group">
                            <input type="text"
                                   class="form-control w-50"
                                   data-ng-pattern="/^[^!|&[\]{}()«»\<\>_^@~\-\x20\xa0\x27\x22\.,;=][^!|&[\]{}()\\/«»<>_^@~\x20\xa0\x27\x22\.,;=]{1,63}[^!|&[\]{}()\\/«»<>_^@~\-\x20\xa0\x27\x22\.,;=]$/"
                                   id="inputDomain"
                                   data-ng-model="$ctrl.model.domain"
                                   name="domain"
                                   data-ng-disabled="$ctrl.isActivating"
                                   required data-ng-minlength="1"
                                   data-ng-trim="true"
                                   data-ng-change="$ctrl.scheduleCheckDomainDisponibility();"
                                   placeholder="{{:: 'domain_activation_form_domain_label' | translate | tucCapitalize }}">
                            <select data-ng-model="$ctrl.model.tld"
                                    class="form-control"
                                    name="tld"
                                    data-ng-options="tld.value as tld.label for tld in $ctrl.locker.tldList"
                                    data-ng-disabled="$ctrl.isActivating"
                                    data-ng-change="$ctrl.checkDomainDisponibility();">
                            </select>
                        </div>
                    </div>
                    <div class="mt-2"
                         data-ng-if="$ctrl.toggles.domainLoading">
                        <oui-spinner class="mr-2"
                                     data-size="s">
                        </oui-spinner>
                        <span data-translate="domain_activation_check_dispo"></span>
                    </div>

                    <!-- already in pack-->
                    <div data-ng-if="$ctrl.toggles.domainStatus === 'alreadyActivated'">
                        <h6 class="ovh-font ovh-font-warning text-warning " aria-hidden="true"></h6>
                        <span data-translate="domain_activation_is_already_in_pack"
                              data-translate-values="{ domain: $ctrl.model.domain + '.' + $ctrl.model.tld }">
                        </span>
                    </div>

                    <!-- available -->
                    <div data-ng-if="$ctrl.toggles.domainStatus === 'available'">
                        <div>
                            <h6 class="ovh-font ovh-font-success text-success " aria-hidden="true"></h6>
                            <span data-translate="domain_activation_is_available"
                                  data-translate-values="{ domain : $ctrl.locker.fqdn }">
                            </span>
                        </div>

                        <p class="mt-3" data-translate="domain_activation_you_are"></p>
                        <div class="radio"
                             data-ng-init="$ctrl.model.legalStatus = 'individual'">
                            <label>
                                <input type="radio"
                                       data-ng-model="$ctrl.model.legalStatus"
                                       data-ng-disabled="$ctrl.isActivating"
                                       value="individual"
                                       id="legalStatus"
                                       name="legalStatus"
                                       required>
                                <span data-translate="domain_activation_is_individual"></span>
                            </label>
                            <label>
                                <input type="radio"
                                       data-ng-model="$ctrl.model.legalStatus"
                                       data-ng-disabled="$ctrl.isActivating"
                                       value="corporation"
                                       name="legalStatus">
                                <span data-translate="domain_activation_is_corporation"></span>
                            </label>
                            <label>
                                <input type="radio"
                                       data-ng-model="$ctrl.model.legalStatus"
                                       data-ng-disabled="$ctrl.isActivating"
                                       value="association"
                                       name="legalStatus">
                                <span data-translate="domain_activation_is_association"></span>
                            </label>
                        </div>
                    </div>

                    <!-- unavailable -->
                    <div data-ng-if="$ctrl.toggles.domainStatus === 'unavailable'">
                        <div>
                            <h6 class="ovh-font ovh-font-warning text-warning " aria-hidden="true"></h6>
                            <span data-translate="domain_activation_is_unavailable"
                                  data-translate-values="{ domain: $ctrl.model.domain + '.' + $ctrl.model.tld }">
                            </span>
                        </div>

                        <p class="mt-3" data-translate="domain_activation_do_you_transfert"></p>

                        <div class="btn-group d-block clearfix mb-3">
                            <label class="btn btn-default"
                                   data-ng-model="$ctrl.toggles.transfertWanted"
                                   data-uib-btn-radio="true"
                                   data-translate="common_yes_capitalized">
                            </label>

                            <label class="btn btn-default"
                                   data-ng-model="$ctrl.toggles.transfertWanted"
                                   data-uib-btn-radio="false"
                                   data-translate="common_no_capitalized">
                            </label>
                        </div>

                        <div class="alert alert-info"
                             role="alert"
                             data-translate="domain_activation_authinfo_info">
                        </div>

                        <div  data-ng-if="$ctrl.toggles.transfertWanted">
                            <label class="control-label"
                                   for="formAuthInfo">
                                <span data-translate="domain_activation_form_authinfo"></span>
                                <span>*</span>
                            </label>
                            <input id="formAuthInfo"
                                   name="authinfo"
                                   data-ng-model="$ctrl.model.authInfo"
                                   class="form-control" data-ng-pattern="/^\S{8,}$/"
                                   required
                                   data-translate-attr="{ placeholder : 'domain_activation_form_authinfo' }">
                        </div>
                    </div>


                    <!-- validation button -->
                    <div data-ng-if="$ctrl.toggles.transfertWanted || $ctrl.model.action === 'create'">
                        <button type="button"
                                class="btn btn-primary mt-5"
                                data-ng-click="submit()"
                                data-ng-disabled="$ctrl.isActivating || !domainActivation.$valid || $ctrl.toggles.domainLoading || $ctrl.toggles.loading > 0">
                            <oui-spinner data-ng-if="$ctrl.isActivating"
                                         data-size="s">
                            </oui-spinner>
                            <span data-ng-if="$ctrl.toggles.transfertWanted" data-translate="domain_activation_form_ok_transfert_button"></span>
                            <span data-ng-if="$ctrl.model.action === 'create'" data-translate="domain_activation_form_ok_activate_button"></span>
                        </button>
                    </div>
                </form>

                <div class="alert alert-warning"
                     role="alert"
                     data-ng-if="$ctrl.locker.tldList.length === 0"
                     data-translate="domain_activation_no_tld">
                </div>
            </section>
        </div>
    </div>

</div>
